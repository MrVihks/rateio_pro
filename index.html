<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <title>Rateio Pro</title>
    <style>
      :root{
        --brand-color: #1E2631;
        --light-color:#EDF0F3;
        --mid-color:#DBE0E6;
        --dark-color:#171C22;

        --start-color:#00B021;
        --start-color-dark: color-mix(in srgb, var(--start-color) 80%, black);

        --error-color:#F27D7F;
        --error-color-dark: color-mix(in srgb, var(--error-color) 80%, black);

        --warning-color:#DBC143;
        --warning-color-dark: color-mix(in srgb, var(--warning-color) 80%, black);

        --link-color:#4256D7;
        --border-color:#C6D0D7;
      }
      
      *{
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      .section{
        display: flex;
        flex-direction: column;
        gap: 20px;

        align-items: center;

        background-color: var(--mid-color);

        padding: 40px;
      }
      .custom_file_input{
        display: flex;
        font-family: "Lato";

        border: 1.2px solid var(--brand-color);
        border-radius: 5px;

        padding: 15px;

        cursor: pointer;
        
        width: 100%;
        min-height: 50px;
      }
      .input{
        display: flex;
        
        padding: 15px;

        width: 100%;
        
        border: 1.2px solid var(--brand-color);
        border-radius: 5px;
        
        background-color: var(--light-color);

        font-weight: 400;
        font-size: 1rem;
      }
      .title{
        font-family: "Montserrat";
        font-weight: bold;
        font-size: 2.5rem;
    
        color: var(--dark-color);
      }
      .subtitle{
        font-family: "Montserrat";
        font-weight: 500;
        font-size: 1.5rem;
    
        color: var(--dark-color);
      }
      .paragraph{
        font-family: "Lato";
        font-size: 1rem;
        font-weight: 400;

        color: var(--dark-color);
      }
      .text-center{
        text-align: center;
      }
      .bold{
        font-weight: bold;
      }
      .link{
        font-size: 1rem;
        font-weight: bold;
        font-family: "Lato";
        text-decoration: underline;
        
        color: var(--link-color);
      }
      .input_container, .file_input_container{
        position: relative;

        min-width: 300px;
      
        margin-top: 15px;

        font-family: "Lato";
        color: var(--brand-color);
      }
      .placeholder{
        position: absolute;
        top: -10px;
        left: 10px;
          
        background-color: var(--light-color);
      }
      .card{
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;

        border: 2px solid var(--border-color);
        border-radius: 6px;
        
        background-color: var(--light-color);

        width: 50%;

        padding: 30px 5px;
      }
      .btn{
        display: flex;
        justify-content: center;
        align-items: center;

        padding: 15px;
       
        min-width: 300px;

        font-family: "Lato";
        font-weight: 400;
        font-size: 1rem;

        border: none;
        border-radius: 5px;

        color: var(--light-color);
        
        transition-duration: 300ms;
      }
      .start{
        background-color: var(--start-color);
      }
      .start:hover{
        background-color: var(--start-color-dark);
      }
      .error{
        background-color: var(--error-color);
      }
      .error:hover{
        background-color: var(--error-color-dark);
      }
      .warning{
        background-color: var(--warning-color);
      }
      .warning:hover{
        background-color: var(--warning-color-dark);
      }
      .invisible{
        display: none;
      }
      .full{
        min-height: 100vh;
      }
      .navbar{
        width: 100%;
        height: 65px;

        background-color: var(--brand-color);
      }

      input[type="file"] {
        display: none;
      }    
      .btn:disabled{
        background-color: var(--border-color);
      }

      .modal{
        animation: 0.3s linear alternate opacity-anim;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;

        gap: 10px;

        width: 50%;
        padding: 10px;

        position: absolute;
        z-index: 10;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        margin-top: 20px;

        background-color: var(--light-color);

        border: 2px solid var(--border-color);
        border-radius: 6px;
      }
      .modal_container{
        display: flex;
        flex-direction: column;

        gap: 20px;

        padding: 10px;
      }
      .modal_container article{
        display: flex;
        flex-direction: column;
        
        text-align: center;
        gap: 10px;
      }
      hr{
        background-color: var(--border-color);
      }

      .hidden{
        display: none;
      }

      @keyframes opacity-anim{
        0%{
          opacity: 0;
        }
        50%{
          opacity: 0.5;
        }
        100%{
          opacity: 1;
        }
      }
      @keyframes scale-anim{
        0%{
          scale: 0;
        }
        50%{
          scale: 0.5;
        }
        100%{
          scale: 1;
        }
      }

      .ticket_header{
        display: flex;
        gap:10px;
        padding: 15px;

        background-color: var(--light-color);
        
        border: 2px solid var(--border-color);
        border-radius: 5px;

        width: 100%;
      }
      .ticket_header_column li{
        display: flex;
        gap:5px;
        padding: 5px;
      }
      
      .ticket_container{
        display: flex;
        flex-direction: column;
        gap: 20px;

        width: 75%;
      }
      .ticket_info{
        display: flex;
        flex-direction: column;
        gap:10px;
        padding: 15px;

        background-color: var(--light-color);
        
        border: 2px solid var(--border-color);
        border-radius: 5px;

        width: 50%;
      }
      .ticket_info_container{
        display: flex;
        
        gap: 20px;
      }
      .ticket_config{
        display: flex;
        flex-direction: column;
        gap:10px;
        padding: 15px;

        background-color: var(--light-color);
        
        border: 2px solid var(--border-color);
        border-radius: 5px;

        width: 60%;
      }
      .buttons_container{
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      textarea{
        min-width:  100%;
        max-width: 100%;
        min-height: 100px;
        max-height: 150px;
      }
    </style>
</head>
<body>
    <nav class="navbar">
    </nav>
    <div class="modal hidden" id="rateio-modal">
      <h1 class="subtitle bold">Mais informações sobre o Rateio</h1>
      <div class="modal_container">
         <article>
            <h2 class="subtitle">O que é o rateio?</h2>
            <p class="paragraph">Lorem ipsum dolor sit amet consectetur adipisicing elit. Nobis illo officiis quam ratione quaerat. Illum est excepturi rerum soluta minus, eligendi deleniti qui reprehenderit quis quibusdam dolore magnam deserunt molestias.</p>
            <hr>
         </article>
          <article>
            <h2 class="subtitle">Como fazer o rateio?</h2>
            <p class="paragraph">Lorem ipsum dolor sit amet consectetur adipisicing elit. Harum, quae dignissimos autem consectetur cum soluta recusandae aut ipsam, perspiciatis earum error quia aliquid, dolorum a quos tenetur fugiat sit adipisci!</p>
            <hr>
          </article>
          <article>
            <h2 class="subtitle">Por que é necessário ter uma planilha do GLPI?</h2>
            <p class="paragraph">Lorem ipsum dolor sit amet consectetur adipisicing elit. Optio dolor fugit nisi, a rem, sequi nulla, saepe maxime obcaecati maiores ratione cumque non dicta ea aliquam facilis expedita. Corrupti, eligendi.</p>
            <hr>
          </article>
          <article>
            <h2 class="subtitle">Por que é necessário ter uma planilha do 'Sistema Ponto'?</h2>
            <p class="paragraph">Lorem ipsum dolor sit amet consectetur adipisicing elit. Excepturi minus voluptatem corporis sunt tempore illum sequi. Est, magni modi, dolor, eos odio ipsam nesciunt quod mollitia officiis dignissimos excepturi atque!</p>  
          </article>
      </div>
      <div class="modal_buttons">
        <button class="btn error" onclick="closeModal('rateio-modal')">Fechar</button> 
      </div>
    </div>

    <section id="main" class="full section hidden">
      <h1 class="title">Criar Rateio</h1>
        <article class="card">
            <h2 class="subtitle">Configurações iniciais</h2>
           
            <p class="file_input_container">
                <label for="rateio_file" class="custom_file_input">
                  <a class="placeholder">Enviar planilha do GLPI</a>
                  <input type="file" name="rateio_file" id="rateio_file" class="input" accept=".xls, .xlsx, .csv">
                </label>
            </p>
            <p class="file_input_container">
              <label for="ponto_file" class="custom_file_input">
                <a class="placeholder">Enviar planilha do ponto</a>
                <input type="file" name="ponto_file" id="ponto_file" class="input" accept=".xls, .xlsx, .csv">
              </label>
            </p>
            <button onclick="generateExcel()" class="btn start" disabled>Iniciar</button>
            <button class="btn warning" disabled>Validar</button>
            <p class="paragraph text-center" style="width: 400px;">Para iniciar a criação de um rateio, é necessário ter o
            <span class="bold">CSV do GLPI</span> e a <span class="bold">planilha do sistema ponto.</span></p>
            <a onclick="openModal('rateio-modal')" class="link" style="cursor: pointer;">Saiba mais</a>
        </article>
    </section>

    <section id="tickets" class="full section">
        <h1 id="ticket_title" class="title" style="font-weight: 500;">Entrega de cadeiras(<a id="ticket_url" style="text-decoration: underline; cursor: pointer;" class="bold title">995954</a>)</h1>

        <section class="ticket_container">
          <article class="ticket_header">
            <ul class="ticket_header_column">
              <li><p class="paragraph bold">Requerente</p>:<p class="paragraph" id="ticket_author"></p></li>
              <li><p class="paragraph bold">Data de abertura</p>:<p class="paragraph" id="ticket_opendate"></p></li>
              <li><p class="paragraph bold">Andar</p>:<p class="paragraph" id="ticket_floor"></p></li>
            </ul>
            <ul class="ticket_header_column">
              <li><p class="paragraph bold">Filial</p>:<p class="paragraph" id="ticket_office"></p></li>
              <li><p class="paragraph bold">Atribuido</p>:<p class="paragraph" id="ticket_assigned"></p></li>
              <li><p class="paragraph bold">Data de solução</p>:<p class="paragraph" id="ticket_solutiondate"></p></li>
            </ul>
          </article>
          <section class="ticket_info_container">
            <article class="ticket_info">
              <h2 class="subtitle">Descrição do chamado</h2>
              <p class="paragraph" id="ticket_description">Lorem ipsum dolor sit amet consectetur adipisicing elit. Obcaecati, hic cupiditate alias accusamus aperiam libero laboriosam voluptatibus culpa error, tenetur nostrum officia sit. Et id neque cupiditate dolorum aliquid tenetur?</p>
            </article>
            <article class="ticket_config">
              <div>
                <p class="input_container">
                  <label for="ticket_items" class="placeholder">Dispositivos no chamado</label>
                  <input type="text" id="ticket_items" name="ticket_items" class="input">
                  <p class="paragraph bold">0 Dispositivos encontrados</p>
                </p>
                <p class="input_container" style="margin-top: 25px;">
                  <label for="ticket_cpfs" class="placeholder">CPFs</label>
                  <textarea type="text" id="ticket_cpfs" name="ticket_cpfs" class="input"></textarea>
                  <p class="paragraph bold">0 CPFs encontrados</p>
                </p>
                <p class="input_container" style="margin-top: 25px;">
                  <label for="ticket_patrim" class="placeholder">Patrimônios</label>
                  <textarea type="text" id="ticket_patrim" name="ticket_patrim" class="input"></textarea>
                  <p class="paragraph bold">0 Patrimônios encontrados</p>
                </p>
                <p class="input_container" style="margin-top: 25px;">
                  <label for="ticket_separator" class="placeholder">Separador</label>
                  <input type="text" id="ticket_separator" name="ticket_separator" class="input"></input>
                  <p class="paragraph bold">(-) é o separador selecionado</p>
                </p>
              </div>
              <div class="buttons_container">
                  <button onclick="" class="btn start">Salvar</button>
                  <button class="btn error">Deletar</button>
                  <button class="btn warning">Ver todos os chamados</button>
              </div>
            </article>
          </section>
        </section>    
      </section>
    
    <script>
       function closeModal(modalId){
          const modal = document.querySelector(`#${modalId}`)

          modal.classList.remove("modal")
          modal.classList.add("hidden")
        }
        function openModal(modalId){
          const modal = document.querySelector(`#${modalId}`)

          modal.classList.remove("hidden")
          modal.classList.add("modal")
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/exceljs@4.4.0/dist/exceljs.min.js"></script>
    <script>
        async function generateExcel() {
            // Criar um novo workbook
            const workbook = new ExcelJS.Workbook();
            workbook.creator = 'Seu Nome';
            workbook.created = new Date();

            // Adicionar uma worksheet
            const sheet = workbook.addWorksheet('Minha Planilha');

            // Adicionar dados à planilha
            sheet.addRow(['ID', 'Nome', 'Idade', 'Salário']); // Cabeçalhos
            sheet.addRow([1, 'João Silva', 30, 5000]);
            sheet.addRow([2, 'Maria Oliveira', 25, 4500]);
            sheet.addRow([3, 'Pedro Santos', 40, 6000]);

            // Definir a tabela
            sheet.addTable({
                name: 'MinhaTabela', // Nome único da tabela
                ref: 'A1:D4', // Intervalo da tabela (A1 até D4, incluindo cabeçalhos)
                headerRow: true, // Indica que a primeira linha é o cabeçalho
                totalsRow: false, // Desativa linha de totais (opcional)
                style: {
                    theme: 'TableStyleMedium9', // Estilo predefinido do Excel
                    showRowStripes: true, // Linhas alternadas com cores
                    showFilterButton: true // Ativa botões de filtro
                },
                columns: [
                    { name: 'ID', filterButton: true },
                    { name: 'Nome', filterButton: true },
                    { name: 'Idade', filterButton: true },
                    { name: 'Salário', filterButton: true }
                ],
                rows: [
                    [1, 'João Silva', 30, 5000],
                    [2, 'Maria Oliveira', 25, 4500],
                    [3, 'Pedro Santos', 40, 6000]
                ]
            });

            // Opcional: Ajustar formatação adicional
            const table = sheet.getTable('MinhaTabela');
            if (table && table.ref) {
                table.ref.split(':').forEach(cell => {
                    sheet.getCell(cell).border = {
                        top: { style: 'thin' },
                        left: { style: 'thin' },
                        bottom: { style: 'thin' },
                        right: { style: 'thin' }
                    };
                });
            } else {
                console.error('Tabela não encontrada ou ref está indefinido.');
            }

            // Gerar o arquivo e fazer download
            const buffer = await workbook.xlsx.writeBuffer();
            const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'tabela_formatada.xlsx';
            link.click();
            URL.revokeObjectURL(link.href);
        }
    </script>

    <script>

        const sections = [{id:1, cssId:"main"},{id:2, cssId:"create"}]
        
        function renderSection(section){
            const render = document.querySelector("#render");
            render.innerHTML = section.innerHTML;
        }
        

        renderSection(document.querySelector(`#${sections[1].cssId}`))
    </script>
</body>
</html>